<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>æ™ºæ…§é›»è¦–å¿«å•å¿«ç­” - ç¬¬ä¸‰é—œ</title>
  <style>
    body {
      margin: 0;
      background: #111;
      color: #fff;
      font-family: sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      padding: 20px;
      flex-direction: column;
      text-align: center;
    }
    img {
      max-width: 120vw;
      max-height: 90vh;
      display: none;
      opacity: 0;
      transition: opacity 1s ease;
    }
    .fade-in {
      opacity: 1 !important;
    }
    .question-box {
      display: none;
      background: #222;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      transform: translateY(20px);
      opacity: 0;
      transition: all 0.6s ease;
    }
    .question-box.show {
      transform: translateY(0);
      opacity: 1;
    }
    .keypad button {
      font-size: 24px;
      margin: 5px;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background-color: #444;
      color: #fff;
      cursor: pointer;
      transition: transform 0.1s ease;
    }
    .keypad button:active {
      transform: scale(0.95);
    }
    .keypad-display {
      font-size: 24px;
      margin-bottom: 10px;
    }
    #startScreen {
      background: #222;
      padding: 20px;
      border-radius: 10px;
    }
    #startScreen button {
      margin-top: 20px;
      font-size: 24px;
      padding: 10px 30px;
      border-radius: 8px;
      background: #08f;
      color: #fff;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <audio id="bgm" src="music/hurry.mp3" loop></audio>
  <audio id="success" src="music/success.mp3"></audio>

  <div id="startScreen">
    <h2>ç¬¬ä¸‰é—œï¼šå¿«å•å¿«ç­”</h2>
    <p>æ¯ä¸€é¡Œæœƒé¡¯ç¤ºä¸€å¼µç…§ç‰‡ 5 ç§’ï¼Œè«‹ä»”ç´°è§€å¯Ÿã€‚</p>
    <p>ä¹‹å¾Œå°‡å‡ºç¾èˆ‡ç…§ç‰‡ç›¸é—œçš„å•é¡Œï¼Œè«‹è¼¸å…¥æ­£ç¢ºçš„æ•¸å­—ç­”æ¡ˆã€‚</p>
    <button onclick="startQuiz()">é–‹å§‹</button>
  </div>

  <div id="photoContainer">
    <img id="photo" src="" alt="å•é¡Œåœ–ç‰‡">
</div>
<div id="multiPhotoContainer" style="display:none; gap: 10px; flex-wrap: wrap; justify-content: center; align-items: flex-start;"></div>

  <div class="question-box" id="questionBox">
    <p id="question"></p>
    <div class="keypad-display" id="answerDisplay"></div>
    <div class="keypad" id="keypad"></div>
    <button id="nextBtn" onclick="nextQuestion()" style="display:none; margin-top: 10px;">â¡ï¸ ä¸‹ä¸€é¡Œ</button>
  </div>

  <script>
    const photos = ["3-1.JPG","3-2.JPG","3-3.JPG","3-4.JPG","3-5.JPG"];
    const questions = [
      { q: "ç…§ç‰‡è£¡æœ‰å¹¾éš»çœ¼ç›ï¼Ÿ", ans: "8" },
      { q: "ç…§ç‰‡è£¡æœ‰å¹¾ç¨®å‹•ç‰©ï¼Ÿ", ans: "6" },
      { q: "èª°è·³å¾—æœ€é«˜ï¼Ÿ", ans: "2", multi: ["3-3-1.JPG", "3-3-2.JPG", "3-3-3.JPG", "3-3-4.JPG"] },
      { q: "ç´…è‰²çƒæœ‰å¹¾é¡†ï¼Ÿ", ans: "4" },
      { q: "èƒŒæ™¯ä¸­æœ‰å¹¾æ£µæ¨¹ï¼Ÿ", ans: "5" },
    ];

    let current = 0;
let attempts = 0;
    let input = "";
    let confirmBtn;

    const photo = document.getElementById('photo');
    const questionBox = document.getElementById('questionBox');
const multiPhotoContainer = document.getElementById('multiPhotoContainer');
    const questionText = document.getElementById('question');
    const answerDisplay = document.getElementById('answerDisplay');
    const nextBtn = document.getElementById('nextBtn');
    const startScreen = document.getElementById('startScreen');
    const bgm = document.getElementById('bgm');

    function startQuiz() {
      startScreen.style.display = 'none';
      bgm.play();
      showPhoto();
    }

    function showPhoto() {
      photo.classList.remove('fade-in');
      photo.style.display = 'none';
      multiPhotoContainer.innerHTML = "";
      multiPhotoContainer.style.display = 'none';

      const q = questions[current];
      if (q.multi) {
        multiPhotoContainer.style.display = 'flex';
        q.multi.forEach((file, index) => {
          const wrapper = document.createElement('div');
          wrapper.style.display = 'flex';
          wrapper.style.flexDirection = 'column';
          wrapper.style.alignItems = 'center';

          const img = document.createElement('img');
          img.src = `img/level3/${file}`;
          img.style.display = 'block';
          img.style.opacity = '1';
          img.style.maxWidth = '300px';
          img.style.margin = '5px';
          img.style.border = '2px solid #fff';

          const label = document.createElement('div');
          label.textContent = `${index + 1}`;
          label.style.marginTop = '4px';
          label.style.fontSize = '18px';

          wrapper.appendChild(img);
          wrapper.appendChild(label);
          multiPhotoContainer.appendChild(wrapper);
        });
      } else {
        photo.src = `img/level3/${photos[current]}`;
        photo.style.display = 'block';
        setTimeout(() => {
          photo.classList.add('fade-in');
        }, 50);
      }

      questionBox.classList.remove('show');
      questionBox.style.display = 'none';
      nextBtn.style.display = 'none';

      setTimeout(() => {
        photo.style.display = 'none';
        multiPhotoContainer.style.display = 'none';
        showQuestion();
      }, 5000);
    }

    function showQuestion() {
      questionBox.style.display = 'block';
      setTimeout(() => questionBox.classList.add('show'), 10);
      questionText.textContent = questions[current].q;
      answerDisplay.textContent = input;

      if (!confirmBtn) {
        confirmBtn = document.createElement('button');
        confirmBtn.textContent = 'ç¢ºå®š';
        confirmBtn.style.marginTop = '10px';
        confirmBtn.onclick = checkAnswer;
        questionBox.appendChild(confirmBtn);
      }
      confirmBtn.style.display = 'inline-block';
      nextBtn.style.display = 'none';
    }
      

    function inputAnswer(n) {
      input += n;
      answerDisplay.textContent = input;
    }

    function resetAnswer() {
      input = "";
      answerDisplay.textContent = "";
    }

    function nextQuestion() {
      current++;
      input = "";
      if (current >= questions.length) {
        alert("ğŸ‰ å…¨éƒ¨ç­”å°ï¼Œé€²å…¥ä¸‹ä¸€é—œï¼");
        window.location.href = "https://suskboled.github.io/puzzle_2025/level_4.html";
        return;
      }
      showPhoto();
    }

    // å»ºç«‹æ•¸å­—éµç›¤
    const keypad = document.getElementById('keypad');
    const digits = [0,1,2,3,4,5,6,7,8,9];
    digits.forEach(n => {
      const btn = document.createElement('button');
      btn.textContent = n;
      btn.onclick = () => inputAnswer(n);
      keypad.appendChild(btn);
    });
    const resetBtn = document.createElement('button');
    resetBtn.textContent = 'é‡è¨­';
    resetBtn.onclick = resetAnswer;
    keypad.appendChild(resetBtn);
  function checkAnswer() {
  if (current === 2 && attempts === 0) {
    // ç¬¬ä¸€æ¬¡å›ç­”ç¬¬ä¸‰é¡Œï¼Œä¸€å¾‹è¦–ç‚ºéŒ¯èª¤ä¸¦æ›´æ›åœ–ç‰‡
    questions[2].multi = ["3-3-1.JPG", "3-3-2.png", "3-3-3.JPG", "3-3-4.JPG"];
    attempts++;
    input = "";
    answerDisplay.textContent = "";
    questionBox.style.display = 'none';
    showPhoto();
    return;
  }

  if (input === questions[current].ans) {
    document.getElementById('success').play();
    nextBtn.style.display = 'inline-block';
    confirmBtn.style.display = 'none';
    attempts = 0; // reset for next question
  } else {
    input = "";
    answerDisplay.textContent = "";
    questionBox.style.display = 'none';
    showPhoto();
  }
} 

    </script>
</body>
</html>
